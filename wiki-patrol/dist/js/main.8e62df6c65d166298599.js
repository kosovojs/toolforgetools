!function(e){function t(t){for(var n,i,s=t[0],c=t[1],u=t[2],f=0,p=[];f<s.length;f++)i=s[f],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);p.length;)p.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==a[c]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={0:0},o=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([49,1]),r()}({39:function(e,t,r){},49:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(9),i=r.n(o),s=r(10),c=(r(40),r(17)),u=r(13),l=r.n(u),f=r(14),p=r.n(f),d=r(15),m=r.n(d),b=r(8),h=r.n(b),v=r(16),g=r.n(v),y=r(1),O=r.n(y),w=r(21),E=r.n(w),j=r(5),k=r.n(j),P=r(6);var S=function(e,t,r){var n=null,a=!1;try{n=JSON.parse(t),a=!0}catch(e){n=t}this.response=n,this.message=e,this.status=r,P.b.error("Serveris atgrieza kļūdu: ".concat(this.toString()),{autoClose:1e4}),this.toString=function(){return"".concat(this.message,"\nResponse:\n").concat(a?JSON.stringify(this.response,null,2):this.response)}},R="//edgars.toolforge.org/wiki-patrol/save.php";var C=function(e,t){var r="";"http"==e.substr(0,4)?r=e:R!==e.substr(0,R.length)&&(r=R+e);var n,a=void 0===t||0===Object.keys(t).length?"":(n=t,"?"+Object.keys(n).reduce((function(e,t){return e.push(t+"="+encodeURIComponent(n[t])),e}),[]).join("&"));return"".concat(r).concat(a)};function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n={},a=["post","put","patch"],o=_({},r,{},t,{headers:_({},n,{},t.headers)});o.method=o.method.toLowerCase();var i=o.body instanceof File;o.body&&"object"===E()(o.body)&&!i&&a.indexOf(o.method)>-1&&(o.body=JSON.stringify(o.body));var s=C(e,o.params),c=null;return fetch(s,o).then((function(e){return(c=e).status<200||c.status>=300?c.text():c.json()})).then((function(e){if(c.status<200||c.status>=300)throw e;return e})).catch((function(e){throw c?new S("Request failed with status ".concat(c.status,"."),e,c.status):new S(e.toString(),null,"REQUEST_FAILED")}))},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return x(e,{params:t,method:"get"})},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return x(e,{body:t,method:"post"})},T={mediawiki:{getRC:function(){return N("https://lv.wikipedia.org/w/api.php",{origin:"*",action:"query",format:"json",list:"recentchanges",utf8:1,formatversion:"2",rcnamespace:"0",rcprop:"title|timestamp|ids|comment|flags|loginfo|oresscores|redirect|sizes|tags|user",rcshow:"unpatrolled",rclimit:"100",rctype:"edit|new|log"})},pageRevisions:function(e){return N("https://lv.wikipedia.org/w/api.php",{origin:"*",action:"query",format:"json",prop:"revisions",titles:e,utf8:1,formatversion:"2",rvprop:"ids|timestamp|flags|comment|user",rvlimit:"50"})},userinfo:function(e){return N("https://lv.wikipedia.org/w/api.php",{origin:"*",action:"query",format:"json",list:"users",usprop:"editcount|rights|registration",ususers:e.join("|")})},trustedusers:function(){return N("https://lv.wikipedia.org/w/api.php",{origin:"*",action:"query",format:"json",list:"allusers",augroup:"bureaucrat|autopatrolled|sysop|patroller|bot",aulimit:"max"})},diffRelative:function(e,t){return N("https://lv.wikipedia.org/w/api.php",{origin:"*",action:"compare",format:"json",fromrev:e,torelative:t,prop:"diff|diffsize|comment",utf8:1,formatversion:"2"})},diff:function(e,t){return N("https://lv.wikipedia.org/w/api.php",{origin:"*",action:"compare",format:"json",fromrev:e,torev:t,prop:"diff|diffsize|comment",utf8:1,formatversion:"2"})}},tool:{getRC:function(){return N("",{action:"rc"})},patrolEdits:function(e){return L("",{action:"patrol_edits",edits:e})},saveLastGoodVersion:function(e,t,r){return L("",{action:"save_last_good",article:e,rev:t,editsForPatrol:r})}}},A=r(27),F=r.n(A);function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var G=Object(c.b)({name:"rc",initialState:{entries:{},loading:!1,error:!1,error_msg:null},reducers:{setRC:{reducer:function(e,t){return I({},e,{entries:t.payload.entries})},prepare:function(e){return{payload:{entries:e}}}},setLoading:{reducer:function(e){return I({},e,{loading:!0})}},setSucess:{reducer:function(e){return I({},e,{loading:!1})}}}}),q=G.actions,z=q.setRC,M=q.setLoading,J=q.setSucess,V=function(){return function(e){e(M());T.tool.getRC().then((function(t){var r,n,a=(r=t.query.recentchanges,n={},r.forEach((function(e){var t=e.title,r=F()(e,["title"]);t in n?n[t].push(r):n[t]=[r]})),n);e(z(a)),e(J())}))}},H=G.reducer,Q=r(28),B=r.n(Q),K=r(12),Z=r.n(K),Y=r(19),W=r.n(Y),X=r(11),$=r.n(X),ee=r(29),te=r(7),re=r.n(te);function ne(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ae=function(e){return e.replace(/ /g,"_")},oe=function(e){g()(n,e);var t,r=(t=n,function(){var e,r=h()(t);if(ne()){var n=h()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return m()(this,e)});function n(e){var t;return l()(this,n),t=r.call(this,e),k()($()(t),"showEdit",(function(e){return function(r){console.log(e),t.setState({diffLoading:!0,editdiff:null}),T.mediawiki.diffRelative(e,"prev").then((function(e){e.compare&&e.compare.body&&t.setState({editdiff:e.compare.body})})).finally((function(){t.setState({diffLoading:!1})}))}})),k()($()(t),"saveLastGoodEdit",W()(Z.a.mark((function e(){var r;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(t.state.lastGoodEdit).length){e.next=5;break}return e.next=3,t.getLastGoodEdit();case 3:r=e.sent,t.setState({lastGoodEdit:r});case 5:T.tool.saveLastGoodVersion(t.props.article,t.state.lastGoodEdit,t.props.entryData).then((function(e){"ok"===e.status&&(P.b.success("darbība saglabāta"),t.setState({editdiff:null,visible:!1}))}));case 6:case"end":return e.stop()}}),e)})))),k()($()(t),"handlePatrolEdit",(function(e){return function(r){T.tool.patrolEdits([e]).then((function(e){"ok"===e.status&&(P.b.success("darbība saglabāta"),t.setState({editdiff:null}))}))}})),k()($()(t),"getLastGoodEdit",W()(Z.a.mark((function e(){var r,n,a,o,i,s,c,u,l,f;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.trusted_users,e.next=3,T.mediawiki.pageRevisions(t.props.article);case 3:n=e.sent,a=B()(t.props.entryData).pop(),o=a.revid,i=n.query.pages[0].revisions,s={},c=0;case 9:if(!(c<i.length)){e.next=23;break}if(u=i[c],l=u.user,f=u.revid,0!==u.parentid){e.next=15;break}return s=u,e.abrupt("break",23);case 15:if(!(o<f)){e.next=17;break}return e.abrupt("continue",20);case 17:if(!r.includes(l)){e.next=20;break}return s=u,e.abrupt("break",23);case 20:c++,e.next=9;break;case 23:return e.abrupt("return",s);case 24:case"end":return e.stop()}}),e)})))),k()($()(t),"showFullEdits",W()(Z.a.mark((function e(){var r;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getLastGoodEdit();case 2:r=e.sent,t.setState({diffLoading:!0,editdiff:null,lastGoodEdit:r}),T.mediawiki.diffRelative(r.revid,"cur").then((function(e){e.compare&&e.compare.body&&t.setState({editdiff:""===e.compare.body?"nav izmaiņu":e.compare.body})})).finally((function(){t.setState({diffLoading:!1})}));case 5:case"end":return e.stop()}}),e)})))),k()($()(t),"patrolEdits",(function(){var e=t.props.entryData.map((function(e){return e.revid}));T.tool.patrolEdits(e).then((function(e){"ok"===e.status&&(P.b.success("darbība saglabāta"),t.setState({editdiff:null,visible:!1}))}))})),t.state={visible:!0,editdiff:null,diffLoading:!1,diffError:!1,diffErrorMsg:null,lastGoodEdit:{}},t}return p()(n,[{key:"render",value:function(){var e,t=this,r=this.props,n=r.article,o=r.entryData,i=this.state,s=i.editdiff,c=i.lastGoodEdit;return i.visible?a.a.createElement("div",{className:re.a.container},a.a.createElement("div",{className:re.a.header},a.a.createElement("div",{className:re.a.articleTitle},(e=n,a.a.createElement("a",{href:"https://lv.wikipedia.org/wiki/".concat(ae(e)),target:"_blank",rel:"noopener noreferrer"},e))),a.a.createElement("div",{className:"btn-group btn-group-sm",role:"group","aria-label":"Basic example"},a.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.showFullEdits},"Kopējās izmaiņas rakstā"),a.a.createElement("button",{type:"button",className:"btn btn-success",onClick:this.patrolEdits},"Pārbaudīts!"),a.a.createElement("button",{type:"button",className:"btn btn-info",onClick:this.saveLastGoodEdit},"Saglabāt pēdējo uzticamo versiju"))),a.a.createElement("br",null),a.a.createElement(a.a.Fragment,null,o.map((function(e){var r=e.revid,n=e.user,o=(e.oldlen,e.newlen,e.timestamp),i=e.comment,s=(e.unpatrolled,e.oresscores.damaging.true);return a.a.createElement("div",{key:r,className:Object(ee.a)(re.a.oneEdit,s>.5&&re.a.badFaith)},a.a.createElement("span",{className:re.a.revTitle},a.a.createElement("a",{href:"https://lv.wikipedia.org/wiki/Special:Diff/".concat(r),target:"_blank",rel:"noopener noreferrer"},o),a.a.createElement("span",{style:{cursor:"pointer"},onClick:function(e){return t.showEdit(r)(e)}}," ","(izmaiņas)"),a.a.createElement("span",{style:{cursor:"pointer"},onClick:function(e){return t.handlePatrolEdit(r)(e)}}," ","(pārbaudīts)")),a.a.createElement("span",{className:re.a.summary},i),a.a.createElement("span",{className:re.a.revUser},"labojuma veicējs:"," ",a.a.createElement("a",{href:"https://lv.wikipedia.org/wiki/User:".concat(n),target:"_blank",rel:"noopener noreferrer"},n)),a.a.createElement("span",{className:re.a.revOres},"ORES ļaunprātīgs labojums: ",100*s))}))),Object.keys(c).length>0&&a.a.createElement(a.a.Fragment,null,"Pēdējo uzticamo labojumu ",c.timestamp," veica ",c.user," ","(",a.a.createElement("a",{href:"https://lv.wikipedia.org/wiki/Special:Diff/".concat(c.revid,"/cur"),target:"_blank",rel:"noopener noreferrer"},"izmaiņas"),")"),s&&a.a.createElement("div",{className:re.a.editContainer},a.a.createElement("table",{className:"diff diff-contentalign-left","data-mw":"interface"},a.a.createElement("tbody",{className:"diff",dangerouslySetInnerHTML:{__html:s}})))):""}}]),n}(n.Component);oe.propTypes={trusted_users:O.a.array,entryData:O.a.array,article:O.a.string.isRequired,error:O.a.bool,loading:O.a.bool,recent_changes:O.a.array,setRCFromAPI:O.a.func};var ie={setRCFromAPI:V},se=Object(s.b)((function(e,t){var r=e.rc,n=e.app;return{entryData:function(e,t){return e.entries[t]}(r,t.article),trusted_users:n.trustedUsers}}),ie)(oe);function ce(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ue=function(e){g()(n,e);var t,r=(t=n,function(){var e,r=h()(t);if(ce()){var n=h()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return m()(this,e)});function n(){return l()(this,n),r.apply(this,arguments)}return p()(n,[{key:"componentDidMount",value:function(){this.props.setRCFromAPI()}},{key:"render",value:function(){var e=this.props,t=e.recent_changes,r=e.loading;e.error;return console.log(t),0===t.length||r?"":a.a.createElement("div",{style:{display:"flex",flexDirection:"column",margin:"1vw"}},t.map((function(e){return a.a.createElement(se,{key:e,article:e})})))}}]),n}(n.Component);ue.propTypes={error:O.a.bool,loading:O.a.bool,recent_changes:O.a.array,setRCFromAPI:O.a.func};var le={setRCFromAPI:V},fe=Object(s.b)((function(e){var t,r=e.rc;return{recent_changes:(t=r,Object.keys(t.entries)),loading:r.loading,error:r.error}}),le)(ue);function pe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var de=function(e){g()(n,e);var t,r=(t=n,function(){var e,r=h()(t);if(pe()){var n=h()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return m()(this,e)});function n(e){var t;return l()(this,n),(t=r.call(this,e)).state={error:null,errorInfo:null},t}return p()(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?a.a.createElement("div",{className:"bodyWrapper"},a.a.createElement("h2",null,"Notika kļūda, ielādējot lapu!"),a.a.createElement("details",{style:{whiteSpace:"pre-wrap"}},this.state.error&&this.state.error.toString(),a.a.createElement("br",null),this.state.errorInfo.componentStack)):this.props.children}}]),n}(a.a.Component);function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}de.propTypes={children:O.a.node};var he=Object(c.b)({name:"app",initialState:{isAuth:!1,user:null,trustedUsers:[]},reducers:{setAuthUser:{reducer:function(e,t){return be({},e,{user:t.payload.user,isAuth:!0})},prepare:function(e){return{payload:{user:e}}}},setTrustedUsers:{reducer:function(e,t){return be({},e,{trustedUsers:t.payload.users})},prepare:function(e){return{payload:{users:e}}}},logout:{reducer:function(e){return be({},e,{user:null,isAuth:!1})}}}}),ve=he.actions,ge=ve.setTrustedUsers,ye=(ve.setAuthUser,ve.logout,he.reducer),Oe=(r(48),function(e){var t=e.trustedUsers;return Object(n.useEffect)((function(){t()}),[]),a.a.createElement(a.a.Fragment,null,a.a.createElement(de,null,a.a.createElement(fe,null)),a.a.createElement(P.a,{position:"bottom-right",autoClose:2500,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnVisibilityChange:!0,draggable:!1,pauseOnHover:!0}))});Oe.propTypes={trustedUsers:O.a.func};var we=Object(s.b)(null,{trustedUsers:function(){return function(e){T.mediawiki.trustedusers().then((function(t){var r=t.query.allusers.map((function(e){return e.name}));e(ge(r))}))}}})(Oe),Ee=r(4),je=Object(Ee.c)({rc:H,app:ye});r(39);var ke=Object(c.a)({reducer:je});i.a.render(a.a.createElement(s.a,{store:ke},a.a.createElement(we,null)),document.getElementById("app"))},7:function(e,t,r){e.exports={container:"gpCwE9TH2EAaq6bcZyooq",badFaith:"_2lMPEA0A2MJaALk4-KepkR",articleTitle:"_1F9NA852lFwsxw-6oztclQ",oneEdit:"_3uh8rbtM4pDA2HYD1nVeQf",header:"_3SZTyiFdsR_tLJOCD6QpPC",revTitle:"_25A0Brmpoc5LHtQdK0ABYO",revUser:"_58IRUUDihG45Zc29COVt0",revOres:"aPVbfnC6eT3TPErJongNt",revTime:"_3JGkLeciTfXV42CCKQwIbw",editContainer:"_36CvmRoVDIAfIm4OREH3-u",summary:"aGUJrHNE1CSM8KFFdrqai"}}});
//# sourceMappingURL=main.8e62df6c65d166298599.js.map
